{"version":3,"sources":["lib/webgl.ts","assets/diam.mp3","assets/exit.mp3","assets/expl.mp3","assets/music.mp3","assets/rock.mp3","assets/background.jpg","assets/row-boulder.png","assets/row-diam.png","assets/exit.png","assets/row-explo.png","assets/ground.png","assets/row-walk.png","assets/row-monster.png","assets/wall.jpg","assets/hue.vert","assets/hue.frag","assets/coords.vert","assets/coords-move.vert","assets/transition.vert","assets/transition.frag","assets/background.vert","assets/background.frag","assets/wall.vert","assets/wall.frag","assets/level.vert","assets/level.frag","assets/rain.vert","assets/rain.frag","assets.ts","index.tsx"],"names":["__webpack_require__","WebGL","endsWith","text","arg","trim","toLowerCase","i","arguments","length","substr","Program","gl","codes","includes","vert","Error","frag","id","code","result","split","map","line","pos","indexOf","includeName","charAt","snippet","join","parseIncludes","this","Object","freeze","_typesNamesLookup","k","v","lookup","getTypesNamesLookup","shaderProgram","createProgram","shaderVert","getShader","VERTEX_SHADER","getVertexShader","shaderFrag","FRAGMENT_SHADER","getFragmentShader","attachShader","linkProgram","program","use","that","index","item","attribs","attribsCount","getProgramParameter","ACTIVE_ATTRIBUTES","getActiveAttrib","typeName","getTypeName","type","getSize","call","location","getAttribLocation","name","createAttributes","uniforms","uniformsCount","ACTIVE_UNIFORMS","getActiveUniform","getUniformLocation","defineProperty","set","createUniformSetter","get","createUniformGetter","enumerable","configurable","createUniforms","prototype","destroy","deleteProgram","useProgram","typeId","BPE","Float32Array","BYTES_PER_ELEMENT","nameGL","nameJS","BYTE","UNSIGNED_BYTE","SHORT","UNSIGNED_SHORT","INT","UNSIGNED_INT","SAMPLER_2D","size","uniform1i","uniform1iv","FLOAT","uniform1f","uniform1fv","FLOAT_VEC3","uniform3fv","FLOAT_VEC4","uniform4fv","FLOAT_MAT3","uniformMatrix3fv","FLOAT_MAT4","uniformMatrix4fv","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","console","log","error","getShaderInfoLog","FLOAT_VEC2","bindAttribs","buffer","bindBuffer","ARRAY_BUFFER","names","Array","slice","totalSize","forEach","attrib","keys","offset","enableVertexAttribArray","vertexAttribPointer","fetchAssets","assets","Promise","resolve","reject","applicationName","show","splash","document","createElement","setAttribute","innerHTML","body","appendChild","progress","window","setTimeout","readyState","addEventListener","then","count","done","key","getElementById","next","url","percent","style","transform","removeChild","hideSplashScreen","img","Image","crossOrigin","onload","bind","onerror","ex","src","audio","slot","_loaded","fetch","response","ok","json","content","catch","fillArrayBuffer","vertices","WebGLRenderingContext","WebGL2RenderingContext","buff","createBuffer","bufferData","STATIC_DRAW","fillElementBuffer","elements","Uint16Array","ELEMENT_ARRAY_BUFFER","newCanvas","canvas","clientWidth","clientHeight","module","exports","p","src_assets","diamSound","exitSound","explSound","musicSound","rockSound","backgroundTexture","boulderTexture","diamTexture","exitTexture","exploTexture","groundTexture","heroTexture","monsterTexture","wallTexture","hueVert","hueFrag","coordsVert","coordsMoveVert","transitionVert","transitionFrag","backgroundVert","backgroundFrag","wallVert","wallFrag","levelVert","levelFrag","rainVert","rainFrag","Assets","ReactDOM","render","react_default","a","Fragment","className","maxLength","defaultValue","e","app","default","go"],"mappings":"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","file":"static/js/main.9fc129e5.chunk.js","sourcesContent":["import \"./webgl.css\"\n\nconst WebGL = function() {\n  function endsWith( text ) {\n    text = text.trim().toLowerCase();\n    var arg;\n    for( var i=1; i<arguments.length; i++ ) {\n      arg = arguments[i].toLowerCase();\n      if( text.substr( text.length - arg.length ) == arg ) return true;\n    }\n    return false;\n  }\n\n  function Program( gl, codes, includes ) {\n    if ( typeof codes.vert !== 'string' ) {\n      throw Error( '[webgl.program] Missing attribute `vert` in argument `codes`!' );\n    }\n    if ( typeof codes.frag !== 'string' ) {\n      throw Error( '[webgl.program] Missing attribute `frag` in argument `codes`!' );\n    }\n\n    codes = parseIncludes( codes, includes );\n\n    this.gl = gl;\n    Object.freeze( this.gl );\n\n    this._typesNamesLookup = getTypesNamesLookup( gl );\n\n    var shaderProgram = gl.createProgram();\n    var shaderVert = getVertexShader( gl, codes.vert );\n    var shaderFrag = getFragmentShader( gl, codes.frag );\n    gl.attachShader( shaderProgram, shaderVert );\n    gl.attachShader( shaderProgram, shaderFrag );\n    gl.linkProgram( shaderProgram );\n    /*\n      gl.detachShader( shaderProgram, shaderVert );\n      gl.deleteShader( shaderVert );\n      gl.detachShader( shaderProgram, shaderFrag );\n      gl.deleteShader( shaderFrag );\n    */\n    this.program = shaderProgram;\n    Object.freeze( this.program );\n\n    this.use();\n    createAttributes( this, gl, shaderProgram );\n    createUniforms( this, gl, shaderProgram );\n  }\n\n  Program.prototype.destroy = function() {\n    this.gl.deleteProgram( this.program );\n  };\n\n  Program.prototype.use = function() {\n    this.gl.useProgram( this.program );\n  };\n\n  Program.prototype.getTypeName = function ( typeId ) {\n    return this._typesNamesLookup[ typeId ];\n  };\n\n  var BPE = ( new Float32Array() ).BYTES_PER_ELEMENT;\n\n  Program.prototype.bindAttribs = function ( buffer ) {\n    this.use();\n    var gl = this.gl;\n    gl.bindBuffer( gl.ARRAY_BUFFER, buffer );\n    var names = Array.prototype.slice.call( arguments, 1 );\n    var totalSize = 0;\n    names.forEach( function ( name ) {\n      var attrib = this.attribs[ name ];\n      if ( !attrib ) {\n        throw \"Cannot find attribute \\\"\" + name + \"\\\"!\\n\" +\n          \"It may be not active because unused in the shader.\\n\" +\n          \"Available attributes are: \" + Object.keys( this.attribs ).map( function ( name ) {\n            return '\"' + name + '\"';\n          } ).join( \", \" );\n      }\n      totalSize += ( attrib.size * attrib.length ) * BPE;\n    }, this );\n    var offset = 0;\n    names.forEach( function ( name ) {\n      var attrib = this.attribs[ name ];\n      gl.enableVertexAttribArray( attrib.location );\n      gl.vertexAttribPointer(\n        attrib.location,\n        attrib.size * attrib.length,\n        gl.FLOAT,\n        false, // No normalisation.\n        totalSize,\n        offset\n      );\n      offset += ( attrib.size * attrib.length ) * BPE;\n    }, this );\n  };\n\n  function createAttributes( that, gl, shaderProgram ) {\n    var index, item;\n    var attribs = {};\n    var attribsCount = gl.getProgramParameter( shaderProgram, gl.ACTIVE_ATTRIBUTES );\n    for ( index = 0; index < attribsCount; index++ ) {\n      item = gl.getActiveAttrib( shaderProgram, index );\n      item.typeName = that.getTypeName( item.type );\n      item.length = getSize.call( that, gl, item );\n      item.location = gl.getAttribLocation( shaderProgram, item.name );\n      attribs[ item.name ] = item;\n    }\n\n    that.attribs = attribs;\n    Object.freeze( that.attribs );\n  }\n\n  function createAttributeSetter( gl, item, shaderProgram ) {\n    var name = item.name;\n    return function ( v ) {\n      if ( typeof v !== 'boolean' ) {\n        throw \"[webgl.program::$\" + name +\n          \"] Value must be a boolean: true if you want to enable this attribute, and false to disable it.\";\n      }\n      if ( v ) {\n        gl.enableVertexAttribArray(\n          gl.getAttribLocation( shaderProgram, name )\n        );\n      } else {\n        gl.disableVertexAttribArray(\n          gl.getAttribLocation( shaderProgram, name )\n        );\n      }\n    };\n  }\n\n  function createAttributeGetter( gl, item, shaderProgram ) {\n    var loc = gl.getAttribLocation( shaderProgram, item.name );\n    return function () {\n      return loc;\n    };\n  }\n\n  function createUniforms( that, gl, shaderProgram ) {\n    var index, item;\n    var uniforms = {};\n    var uniformsCount = gl.getProgramParameter( shaderProgram, gl.ACTIVE_UNIFORMS );\n    for ( index = 0; index < uniformsCount; index++ ) {\n      item = gl.getActiveUniform( shaderProgram, index );\n      uniforms[ item.name ] = gl.getUniformLocation( shaderProgram, item.name );\n      Object.defineProperty( that, '$' + item.name, {\n        set: createUniformSetter( gl, item, uniforms[ item.name ], that._typesNamesLookup ),\n        get: createUniformGetter( item ),\n        enumerable: true,\n        configurable: false\n      } );\n    }\n    that.uniforms = uniforms;\n    Object.freeze( that.uniforms );\n  }\n\n  /**\n   * This is a preprocessor for shaders.\n   * Directives  `#include`  will be  replaced  by  the content  of  the\n   * correspondent attribute in `includes`.\n   */\n  function parseIncludes( codes, includes ) {\n    var result = {};\n    var id, code;\n    for ( id in codes ) {\n      code = codes[ id ];\n      result[ id ] = code.split( '\\n' ).map( function ( line ) {\n        if ( line.trim().substr( 0, 8 ) != '#include' ) return line;\n        var pos = line.indexOf( '#include' ) + 8;\n        var includeName = line.substr( pos ).trim();\n        // We accept all this systaxes:\n        // #include foo\n        // #include 'foo'\n        // #include <foo>\n        // #include \"foo\"\n        if ( \"'<\\\"\".indexOf( includeName.charAt( 0 ) ) > -1 ) {\n          includeName = includeName.substr( 1, includeName.length - 2 );\n        }\n        var snippet = includes[ includeName ];\n        if ( typeof snippet !== 'string' ) {\n          throw Error( \"Include not found in shader: \" + includeName );\n        }\n        return snippet;\n      } ).join( \"\\n\" );\n    }\n    return result;\n  }\n\n\n  function createUniformSetter( gl, item, nameGL, lookup ) {\n    var nameJS = '_$' + item.name;\n\n    switch ( item.type ) {\n    case gl.BYTE:\n    case gl.UNSIGNED_BYTE:\n    case gl.SHORT:\n    case gl.UNSIGNED_SHORT:\n    case gl.INT:\n    case gl.UNSIGNED_INT:\n    case gl.SAMPLER_2D: // For textures, we specify the texture unit.\n      if ( item.size == 1 ) {\n        return function ( v ) {\n          gl.uniform1i( nameGL, v );\n          this[ nameJS ] = v;\n        };\n      } else {\n        return function ( v ) {\n          gl.uniform1iv( nameGL, v );\n          this[ nameJS ] = v;\n        };\n      }\n      break;\n    case gl.FLOAT:\n      if ( item.size == 1 ) {\n        return function ( v ) {\n          gl.uniform1f( nameGL, v );\n          this[ nameJS ] = v;\n        };\n      } else {\n        return function ( v ) {\n          gl.uniform1fv( nameGL, v );\n          this[ nameJS ] = v;\n        };\n      }\n      break;\n    case gl.FLOAT_VEC3:\n      if ( item.size == 1 ) {\n        return function ( v ) {\n          gl.uniform3fv( nameGL, v );\n          this[ nameJS ] = v;\n        };\n      } else {\n        throw Error(\n          \"[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_VEC3 in uniform `\" +\n            item.name + \"'!'\"\n        );\n      }\n      break;\n    case gl.FLOAT_VEC4:\n      if ( item.size == 1 ) {\n        return function ( v ) {\n          gl.uniform4fv( nameGL, v );\n          this[ nameJS ] = v;\n        };\n      } else {\n        throw Error(\n          \"[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_VEC4 in uniform `\" +\n            item.name + \"'!'\"\n        );\n      }\n      break;\n    case gl.FLOAT_MAT3:\n      if ( item.size == 1 ) {\n        return function ( v ) {\n          gl.uniformMatrix3fv( nameGL, false, v );\n          this[ nameJS ] = v;\n        };\n      } else {\n        throw Error(\n          \"[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_MAT3 in uniform `\" +\n            item.name + \"'!'\"\n        );\n      }\n      break;\n    case gl.FLOAT_MAT4:\n      if ( item.size == 1 ) {\n        return function ( v ) {\n          gl.uniformMatrix4fv( nameGL, false, v );\n          this[ nameJS ] = v;\n        };\n      } else {\n        throw Error(\n          \"[webgl.program.createWriter] Don't know how to deal arrays of FLOAT_MAT4 in uniform `\" +\n            item.name + \"'!'\"\n        );\n      }\n      break;\n    default:\n      throw Error(\n        \"[webgl.program.createWriter] Don't know how to deal with uniform `\" +\n          item.name + \"` of type \" + lookup[ item.type ] + \"!\"\n      );\n    }\n  }\n\n  function createUniformGetter( item ) {\n    var name = '_$' + item.name;\n    return function () {\n      return this[ name ];\n    };\n  }\n\n\n  function getShader( type, gl, code ) {\n    var shader = gl.createShader( type );\n    gl.shaderSource( shader, code );\n    gl.compileShader( shader );\n    if ( !gl.getShaderParameter( shader, gl.COMPILE_STATUS ) ) {\n      console.log( code );\n      console.error( \"An error occurred compiling the shader: \" + gl.getShaderInfoLog( shader ) );\n      return null;\n    }\n\n    return shader;\n  }\n\n  function getFragmentShader( gl, code ) {\n    return getShader( gl.FRAGMENT_SHADER, gl, code );\n  }\n\n  function getVertexShader( gl, code ) {\n    return getShader( gl.VERTEX_SHADER, gl, code );\n  }\n\n  function getTypesNamesLookup( gl ) {\n    var lookup = {};\n    var k, v;\n    for ( k in gl ) {\n      v = gl[ k ];\n      if ( typeof v === 'number' ) {\n        lookup[ v ] = k;\n      }\n    }\n    return lookup;\n  }\n\n  function getSize( gl, item ) {\n    switch ( item.type ) {\n    case gl.FLOAT_VEC4:\n      return 4;\n    case gl.FLOAT_VEC3:\n      return 3;\n    case gl.FLOAT_VEC2:\n      return 2;\n    case gl.FLOAT:\n      return 1;\n    default:\n      throw \"[webgl.program:getSize] I don't know the size of the attribute '\" + item.name +\n        \"' because I don't know the type \" + this.getTypeName( item.type ) + \"!\";\n    }\n  }\n\n  function fetchAssets( assets ) {\n    return new Promise(function (resolve, reject) {\n      showSplashScreen().then(function() {\n        var count = 0;\n        var done = 0;\n        for( var key in assets ) count++;\n        var progress = document.getElementById(\"PROGRESS\");\n        var result = {};\n\n        function next( url ) {\n          done++;\n          var percent = done / count;\n          progress.style.transform = \"scaleX(\" + percent + \")\";\n\n          if( done >= count ) {\n            resolve( result );\n            hideSplashScreen();\n            return;\n          }\n        }\n\n        Object.keys( assets ).forEach(function( key ) {\n          var url = assets[key];\n          if( endsWith( url, \"jpg\", \"png\", \"gif\", \"svg\" ) ) {\n            var img = new Image();\n            img.crossOrigin = \"anonymous\";\n            result[key] = img;\n            img.onload = next.bind(null, url);\n            img.onerror = function( ex ) {\n              console.error(\"Unable to load image \\\"\" + key + \"\\\":\", url);\n              console.error( ex );\n              next( url );\n            };\n            img.src = url;\n          } else if( endsWith( url, \"ogg\", \"wav\", \"mp3\" ) ) {\n            var audio = document.createElement(\"audio\");\n            result[key] = audio;\n            var slot = function() {\n              if( audio._loaded ) return;\n              audio._loaded = true;\n              next( url );\n            };\n            audio.addEventListener( \"canplay\", slot );\n            audio.addEventListener( \"loadeddata\", slot );\n            window.setTimeout( slot, 3000 );\n            audio.addEventListener( \"error\", function( ex ) {\n              console.error(\"Unable to load sound \\\"\" + key + \"\\\":\", url);\n              console.error( ex );\n              next( url );\n            });\n            audio.src = url;\n          } else {\n            fetch( url ).then(function(response) {\n              if( !response.ok ) throw \"\";\n              if( endsWith( url, \"json\" ) ) {\n                return response.json();\n              } else {\n                return response.text();\n              }\n            }).then(function(content) {\n              result[key] = content;\n              next( url );\n            }).catch(function(ex) {\n              console.error(\"Unable to fetch asset \\\"\" + key + \"\\\": \", url);\n              next( url );\n            });\n          }\n        });\n      });\n    });\n  }\n\n  function fillArrayBuffer( gl, vertices ) {\n    if( !(gl instanceof WebGLRenderingContext) && !(gl instanceof WebGL2RenderingContext) ) {\n      throw \"Le premier argument de WebGL.fillArrayBuffer doit obligatoirment être de type WebGLRenderingContext ou WebGL2RenderingContext !\";\n    }\n    if( !(vertices instanceof Float32Array) ) {\n      throw \"Le second argument de WebGL.fillArrayBuffer doit obligatoirment être de type Float32Array !\";\n    }\n\n    var buff = gl.createBuffer();\n    gl.bindBuffer( gl.ARRAY_BUFFER, buff );\n    gl.bufferData( gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW );\n    return buff;\n  }\n\n  function fillElementBuffer( gl, elements ) {\n    if( !(gl instanceof WebGLRenderingContext) && !(gl instanceof WebGL2RenderingContext) ) {\n      throw \"Le premier argument de WebGL.fillArrayBuffer doit obligatoirment être de type WebGLRenderingContext ou WebGL2RenderingContext !\";\n    }\n    if( !(elements instanceof Uint16Array) ) {\n      throw \"Le second argument de WebGL.fillArrayBuffer doit obligatoirment être de type Uint16Array !\";\n    }\n\n    var buff = gl.createBuffer();\n    gl.bindBuffer( gl.ELEMENT_ARRAY_BUFFER, buff );\n    gl.bufferData( gl.ELEMENT_ARRAY_BUFFER, elements, gl.STATIC_DRAW );\n    return buff;\n  }\n\n  function newCanvas() {\n    var body = document.body;\n    var canvas = document.createElement( \"canvas\" );\n    canvas.setAttribute( \"width\", body.clientWidth );\n    canvas.setAttribute( \"height\", body.clientHeight );\n    body.appendChild( canvas );\n    return canvas;\n  }\n\n  function showSplashScreen( applicationName ) {\n    if( typeof applicationName === 'undefined' ) applicationName = 'TOLOKOBAN';\n\n    return new Promise(function (resolve, reject) {\n      function show() {\n        var splash = document.createElement( \"div\" );\n        splash.setAttribute( \"id\", \"SPLASH\" );\n        splash.innerHTML = \"<div>\" + applicationName + \"</div><div>\" + applicationName + \"</div>\";\n        document.body.appendChild( splash );\n        var progress = document.createElement( \"div\" );\n        progress.setAttribute( \"id\", \"PROGRESS\" );\n        document.body.appendChild( progress );\n        window.setTimeout(function() {\n          splash.setAttribute( \"class\", \"show\" );\n        }, 50);\n        resolve();\n      }\n      if( document.readyState === \"complete\" ) {\n        show();\n      } else {\n        document.addEventListener( \"DOMContentLoaded\", show );\n      }\n    });\n  }\n\n  function hideSplashScreen() {\n    var splash = document.getElementById( \"SPLASH\" );\n    splash.setAttribute( \"class\", \"hide\" );\n    var progress = document.getElementById( \"PROGRESS\" );\n    document.body.removeChild( progress );\n    window.setTimeout(function() {\n      document.body.removeChild( splash );\n    }, 500);\n  }\n\n\n  //========================================================================================\n  return {\n    Program: Program,\n    fetchAssets: fetchAssets,\n    fillArrayBuffer: fillArrayBuffer,\n    fillElementBuffer: fillElementBuffer,\n    newCanvas: newCanvas\n  };\n}();\n\nexport default WebGL;\n","module.exports = __webpack_public_path__ + \"static/media/diam.22b663f1.mp3\";","module.exports = __webpack_public_path__ + \"static/media/exit.8e36160e.mp3\";","module.exports = __webpack_public_path__ + \"static/media/expl.7dc2d8e9.mp3\";","module.exports = __webpack_public_path__ + \"static/media/music.6c7f2a4e.mp3\";","module.exports = __webpack_public_path__ + \"static/media/rock.9dfde545.mp3\";","module.exports = __webpack_public_path__ + \"static/media/background.2b481ee3.jpg\";","module.exports = __webpack_public_path__ + \"static/media/row-boulder.4b960852.png\";","module.exports = __webpack_public_path__ + \"static/media/row-diam.fbed7ca6.png\";","module.exports = __webpack_public_path__ + \"static/media/exit.2e47f968.png\";","module.exports = __webpack_public_path__ + \"static/media/row-explo.992fe60c.png\";","module.exports = __webpack_public_path__ + \"static/media/ground.0a555d7a.png\";","module.exports = __webpack_public_path__ + \"static/media/row-walk.c6a0075d.png\";","module.exports = __webpack_public_path__ + \"static/media/row-monster.79be3ac1.png\";","module.exports = __webpack_public_path__ + \"static/media/wall.bc9ac803.jpg\";","module.exports = __webpack_public_path__ + \"static/media/hue.2c988a52.vert\";","module.exports = __webpack_public_path__ + \"static/media/hue.c70344c5.frag\";","module.exports = __webpack_public_path__ + \"static/media/coords.0a667af5.vert\";","module.exports = __webpack_public_path__ + \"static/media/coords-move.3655ffb5.vert\";","module.exports = __webpack_public_path__ + \"static/media/transition.29fc1d71.vert\";","module.exports = __webpack_public_path__ + \"static/media/transition.4c773719.frag\";","module.exports = __webpack_public_path__ + \"static/media/background.bf6d184a.vert\";","module.exports = __webpack_public_path__ + \"static/media/background.c266c002.frag\";","module.exports = __webpack_public_path__ + \"static/media/wall.ab246fe9.vert\";","module.exports = __webpack_public_path__ + \"static/media/wall.b699dc58.frag\";","module.exports = __webpack_public_path__ + \"static/media/level.273a6aa9.vert\";","module.exports = __webpack_public_path__ + \"static/media/level.dc63b5ff.frag\";","module.exports = __webpack_public_path__ + \"static/media/rain.9c6fc13a.vert\";","module.exports = __webpack_public_path__ + \"static/media/rain.52499cb7.frag\";","import diamSound from \"./assets/diam.mp3\"\nimport exitSound from \"./assets/exit.mp3\"\nimport explSound from \"./assets/expl.mp3\"\nimport musicSound from \"./assets/music.mp3\"\nimport rockSound from \"./assets/rock.mp3\"\n\nimport backgroundTexture from \"./assets/background.jpg\"\nimport boulderTexture from \"./assets/row-boulder.png\"\nimport diamTexture from \"./assets/row-diam.png\"\nimport exitTexture from \"./assets/exit.png\"\nimport exploTexture from \"./assets/row-explo.png\"\nimport groundTexture from \"./assets/ground.png\"\nimport heroTexture from \"./assets/row-walk.png\"\nimport monsterTexture from \"./assets/row-monster.png\"\nimport wallTexture from \"./assets/wall.jpg\"\n\nimport hueVert from \"./assets/hue.vert\"\nimport hueFrag from \"./assets/hue.frag\"\nimport coordsVert from \"./assets/coords.vert\"\nimport coordsMoveVert from \"./assets/coords-move.vert\"\nimport transitionVert from \"./assets/transition.vert\"\nimport transitionFrag from \"./assets/transition.frag\"\nimport backgroundVert from \"./assets/background.vert\"\nimport backgroundFrag from \"./assets/background.frag\"\nimport wallVert from \"./assets/wall.vert\"\nimport wallFrag from \"./assets/wall.frag\"\nimport levelVert from \"./assets/level.vert\"\nimport levelFrag from \"./assets/level.frag\"\nimport rainVert from \"./assets/rain.vert\"\nimport rainFrag from \"./assets/rain.frag\"\n\n\nexport default {\n    diamSound, exitSound, explSound, musicSound, rockSound,\n\n    backgroundTexture, boulderTexture, diamTexture, exitTexture,\n    exploTexture, groundTexture, heroTexture, monsterTexture, wallTexture,\n\n    hueVert, hueFrag, coordsVert, coordsMoveVert, transitionVert, transitionFrag,\n    backgroundVert, backgroundFrag,\n    wallVert, wallFrag, levelVert, levelFrag, rainVert, rainFrag    \n}\n","import \"./index.css\"\n\nimport React from \"react\";\nimport ReactDOM from 'react-dom'\nimport WebGL from \"./lib/webgl\"\nimport Assets from \"./assets\"\nimport { IAssets } from \"./types\"\n\nWebGL.fetchAssets(Assets).then(start);\n\nfunction start(assets: IAssets) {\n    document.body.removeChild(document.getElementById(\"splash\"));\n    ReactDOM.render((\n        <React.Fragment>\n            <canvas id=\"canvas\"></canvas>\n            <header>\n                <div>Life x <b id='life'>3</b></div>\n                <div><b id='score'>0</b></div>\n                <div id='bonus'>0</div>\n                <div><b id='diam'>12</b> x <img src=\"diam.gif\" /></div>\n            </header>\n            <div id=\"welcome\">\n                <div className=\"tbl\" id=\"highscores\">\n                </div>\n                <center><button id=\"btnStart\">START</button></center>\n            </div>\n            <div id=\"congrat\" className=\"hide\">\n                <div><span id=\"new-score\"></span><span> points</span></div>\n                <input id=\"name\" maxLength=\"9\" size=\"8\" defaultValue=\"\" />\n                <button id=\"btnOk\">OK</button>\n            </div>\n        </React.Fragment>\n    ), document.getElementById(\"root\"));\n\n    import(\"./lib/app\").then(app => {\n        try {\n            console.log(\"app=\", app);\n            app.default.go(assets);\n        }\n        catch (ex) {\n            console.error(ex);\n        }\n    });\n}\n"],"sourceRoot":""}